import{j as e,r as s,a}from"./app-0nnjcZrn.js";import{b as l}from"./index-D7aLGra3.js";import{u as t}from"./use-toast-Dj50PcGS.js";import"./iconBase-x5fZwo94.js";const i=({isOpen:s,onClose:a})=>s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 px-5",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md max-h-72 text-center",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Mahsulot muvaffaqiyatli yuborildi ✅"}),e.jsx("p",{className:"text-slate-500",children:"Xaridingizdan mamnunmiz"}),e.jsx("p",{className:"text-slate-500",children:"Bizning mahsulotlarimizni tanlaganingiz uchun rahmat"}),e.jsx("button",{onClick:a,className:"mt-4 px-6 py-2 bg-black text-white rounded hover:bg-green-900 transition duration-200",children:"Yopish"})]})}):null,r=({detail:r})=>{const[o,n]=s.useState(!1),[c,d]=s.useState(null==r?void 0:r.photo1),[m,x]=s.useState(null),[u,p]=s.useState(null),[h,b]=s.useState(null),[g,j]=s.useState(1),[f,v]=s.useState(!1),{toast:N}=t(),y=s.useMemo(()=>r.variants.map(e=>({...e,sizes:Array.isArray(e.sizes)?e.sizes:[],colors:Array.isArray(e.colors)?e.colors:[]})),[r.variants]),w=s.useMemo(()=>{const e=y.flatMap(e=>e.sizes);return[...new Set(e)]},[y]),z=s.useMemo(()=>m?[...new Set(y.filter(e=>e.sizes.includes(m)).flatMap(e=>e.colors))]:[...new Set(y.flatMap(e=>e.colors))],[y,m]);s.useEffect(()=>{if(m&&u){const e=y.find(e=>e.sizes.includes(m)&&e.colors.includes(u));b(e||null)}else b(null)},[m,u,y]),s.useEffect(()=>{h&&(!m&&h.sizes.length>0&&x(h.sizes[0]),!u&&h.colors.length>0&&p(h.colors[0]))},[h]);return e.jsxs("div",{className:"my-20 px-5 xl:px-32",children:[e.jsxs("div",{className:"grid sm:grid-cols-2 gap-5 md:gap-10 xl:grid-cols-2",children:[e.jsxs("div",{className:"border-b-blue-300 grid gap-4 border-b-2",children:[c&&e.jsx("img",{src:`/storage/${c}?v=${Date.now()}`,loading:"lazy",alt:r.product_name||"Product image",className:"w-full h-[350px] rounded-2xl object-cover"}),e.jsx("div",{className:"grid grid-cols-3 gap-3 mb-3",children:[r.photo1,r.photo2,r.photo3].map((s,a)=>s&&e.jsx("img",{src:`/storage/${s}?v=${Date.now()}`,loading:"lazy",alt:`Product ${a+1}`,className:"w-full h-[130px] object-cover rounded-lg cursor-pointer "+(c===s?"ring-2 ring-blue-400":""),onClick:()=>d(s)},a))})]}),e.jsxs("div",{className:"my-5",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4 font-oswald",children:r.product_name}),e.jsx("h2",{className:"font-semibold mb-2 text-lg",children:"O‘lchamlar:"}),e.jsx("div",{className:"flex gap-2 flex-wrap mb-4",children:w.map((s,a)=>e.jsx("button",{onClick:()=>{x(s),p(null)},className:"border rounded-lg px-4 py-1 cursor-pointer "+(m===s?"bg-black text-white":"bg-gray-100 hover:bg-gray-200"),children:s},a))}),e.jsx("h2",{className:"font-semibold mb-2 text-lg",children:"Ranglar:"}),e.jsx("div",{className:"flex gap-2 flex-wrap mb-4",children:z.map((s,a)=>e.jsx("button",{onClick:()=>p(s),className:"border rounded-full px-4 py-1 cursor-pointer "+(u===s?"bg-black text-white":"bg-gray-100 hover:bg-gray-200"),children:s},a))}),e.jsxs("div",{className:"flex items-center justify-between mt-5",children:[e.jsxs("p",{className:"font-oswald",children:["Narxi:"," ",(null==h?void 0:h.price)??r.price," ",e.jsx("span",{className:"text-sm text-slate-500",children:"so'm"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>j(e=>Math.max(1,e-1)),className:"border px-2",children:"-"}),e.jsx("span",{children:g}),e.jsx("button",{onClick:()=>j(e=>e+1),className:"border px-2",children:"+"})]})]}),e.jsx("button",{onClick:()=>{h&&m&&u?(v(!0),a.post("/add-to-cart",{product_id:r.id,quantity:g,size:m,color:u,price:h.price}).then(()=>{N({title:"Savatga qo‘shildi ✅",description:`${r.product_name} (${m}, ${u}) savatga qo‘shildi!`}),n(!0)}).catch(e=>{var s;console.error(null==(s=e.response)?void 0:s.data),N({title:"Xatolik",description:"Savatga qo‘shishda xatolik yuz berdi.",variant:"destructive"})}).finally(()=>{v(!1)})):N({title:"Xatolik",description:"Iltimos, o‘lcham va rangni tanlang",variant:"destructive"})},disabled:f,className:"mt-4 w-full bg-black text-white py-2 rounded-md disabled:opacity-50",children:f?"Yuklanmoqda...":"Savatga qo‘shish"}),e.jsx("div",{className:"my-5 px-2 pt-2",children:e.jsx("p",{className:"text-black border-b-blue-700 border-b-2 pb-2 cursor-pointer",children:"Tafsilotlar"})}),e.jsx("div",{className:"space-y-2",children:["Kategoriya","Brend","Rangi"].map((s,a)=>{var t;const i=[(null==(t=null==r?void 0:r.category)?void 0:t.name)||"Noma'lum",(null==r?void 0:r.brend)||"Yo‘q",u||"Noma'lum"];return e.jsxs("div",{className:"flex items-center justify-between font-oswald",children:[e.jsx("h3",{style:{fontSize:"20px"},children:s}),e.jsxs("span",{className:"text-slate-600 flex items-center",children:[i[a]," ",e.jsx(l,{})]})]},a)})})]})]}),e.jsx(i,{isOpen:o,onClose:()=>n(!1)})]})};export{r as default};
