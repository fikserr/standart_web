import{r as e,v as a,j as t}from"./app-0nnjcZrn.js";import{u as o}from"./use-toast-Dj50PcGS.js";const s=({product:s,categories:r})=>{const{toast:n}=o(),[l,i]=e.useState({photo1:s.photo1?`/storage/${s.photo1}`:null,photo2:s.photo2?`/storage/${s.photo2}`:null,photo3:s.photo3?`/storage/${s.photo3}`:null}),{data:d,setData:p,processing:c,errors:u}=a({product_name:s.product_name||"",category_id:s.category_id||"",brend:s.brend||"",photo1:s.photo1||"",photo2:s.photo2||"",photo3:s.photo3||"",variants:s.variants&&Array.isArray(s.variants)?s.variants:[{sizes:[],colors:[],price:""}]}),h=e=>{const{name:a,value:t}=e.target;p(a,t)},m=(e,a,t)=>{const o=[...d.variants];o[e][a]="sizes"===a||"colors"===a?t.split(",").map(e=>e.trim()):t,p("variants",o)};return t.jsxs("div",{className:"px-5 w-[1200px]",children:[t.jsx("h1",{className:"text-3xl font-bold mb-4 p-5",children:"Mahsulotni tahrirlash"}),t.jsxs("form",{onSubmit:async e=>{var a,t;e.preventDefault(),n({title:"Yangilanmoqda...",description:"Mahsulot yangilanmoqda, iltimos kuting..."});try{const e=new FormData;e.append("product_name",d.product_name),e.append("category_id",d.category_id),e.append("brend",d.brend),d.photo1 instanceof File?e.append("photo1",d.photo1):e.append("photo_url1",d.photo1),d.photo2 instanceof File?e.append("photo2",d.photo2):e.append("photo_url2",d.photo2),d.photo3 instanceof File?e.append("photo3",d.photo3):e.append("photo_url3",d.photo3),e.append("variants",JSON.stringify(d.variants)),await axios.post(`/admin-products/${s.id}?_method=PUT`,e,{headers:{"Content-Type":"multipart/form-data"}}),n({title:"Muvaffaqiyatli",description:"Mahsulot yangilandi! âœ…"})}catch(o){console.error("Xatolik:",o),n({title:"Xatolik!",variant:"destructive",description:(null==(t=null==(a=null==o?void 0:o.response)?void 0:a.data)?void 0:t.message)??"Serverdan nomaÊ¼lum xatolik"})}},className:"space-y-6 max-w-4xl mx-auto",children:[t.jsx("div",{className:"flex gap-24 justify-center",children:[1,2,3].map(e=>t.jsx("div",{className:"flex flex-col items-center hover:scale-110 transition-all duration-700",children:t.jsxs("div",{className:"relative group w-24 h-24",children:[t.jsx("div",{className:"w-full h-full bg-slate-200 rounded-full flex items-center justify-center shadow-lg overflow-hidden",children:l[`photo${e}`]?t.jsx("img",{src:l[`photo${e}`],loading:"lazy",alt:`Preview ${e}`,className:"w-full h-full object-cover"}):t.jsx("span",{className:"text-5xl animate-pulse",children:"ðŸ“·"})}),t.jsxs("label",{className:"absolute inset-0 flex items-center justify-center cursor-pointer bg-black bg-opacity-0 hover:bg-opacity-30 rounded-full transition",children:[t.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:a=>((e,a)=>{const t=e.target.files[0];if(t){p(a,t);const e=new FileReader;e.onloadend=()=>{i(t=>({...t,[a]:e.result}))},e.readAsDataURL(t)}})(a,`photo${e}`)}),t.jsx("span",{className:"text-xs text-white bg-black bg-opacity-50 px-2 py-1 rounded-full",children:"Upload"})]})]})},e))}),t.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[t.jsx("input",{name:"product_name",value:d.product_name,onChange:h,placeholder:"Product name",className:"w-full border p-5 rounded-lg outline-none"}),u.product_name&&t.jsx("div",{className:"text-red-600",children:u.product_name}),t.jsxs("select",{name:"category_id",value:d.category_id,onChange:h,className:"w-full border p-5 rounded-lg outline-none",children:[t.jsx("option",{value:"",children:"Kategoriya tanlang"}),r.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))]}),u.category_id&&t.jsx("div",{className:"text-red-600",children:u.category_id}),t.jsx("input",{name:"brend",value:d.brend,onChange:h,placeholder:"Brend",className:"w-full border p-5 rounded-lg outline-none"})]}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold mb-2 mt-6",children:"Mahsulot variantlari"}),d.variants.map((e,a)=>t.jsxs("div",{className:"flex gap-4 mb-2 items-center",children:[t.jsx("input",{type:"text",placeholder:"Razmerlar (e.g. S, M, L)",value:Array.isArray(e.sizes)?e.sizes.join(", "):e.sizes,onChange:e=>m(a,"sizes",e.target.value),className:"border p-3 rounded w-1/3"}),t.jsx("input",{type:"text",placeholder:"Ranglar (e.g. red, blue)",value:Array.isArray(e.colors)?e.colors.join(", "):e.colors,onChange:e=>m(a,"colors",e.target.value),className:"border p-3 rounded w-1/3"}),t.jsx("input",{type:"number",placeholder:"Narx (e.g. 100000)",value:e.price,onChange:e=>m(a,"price",e.target.value),className:"border p-3 rounded w-1/3"}),t.jsx("button",{type:"button",onClick:()=>(e=>{const a=d.variants.filter((a,t)=>t!==e);p("variants",a)})(a),className:"text-red-600 text-xl font-bold",children:"âœ•"})]},a)),t.jsx("button",{type:"button",onClick:()=>{p("variants",[...d.variants,{sizes:"",colors:"",price:""}])},className:"mt-2 px-4 py-2 bg-green-600 text-white rounded",children:"âž• Variant qoâ€˜shish"})]}),t.jsx("button",{type:"submit",disabled:c,className:"bg-blue-600 text-white px-4 py-2 rounded mt-6",children:c?"Yangilanmoqda...":"ðŸ’¾ Yangilash"})]})]})};export{s as default};
