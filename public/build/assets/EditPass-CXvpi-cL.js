import{q as s,r as e,j as a,Y as r,a as t}from"./app-0nnjcZrn.js";import{H as o}from"./index-D7aLGra3.js";import{P as i,a as n}from"./index-CZuuonMd.js";import{V as l}from"./VerifyCodeModal-eYrUtj6n.js";import{u as d}from"./use-toast-Dj50PcGS.js";import{P as p}from"./profile-dropdown-DqW-_Lim.js";import{P as c}from"./profile-sidebar-5_oWPxdO.js";import"./iconBase-x5fZwo94.js";import"./dropdown-menu-C9IUMcvQ.js";import"./index-RfUdasAZ.js";import"./index-CdtnVi-6.js";import"./index-CS3As8qO.js";import"./index-jxePHjS3.js";import"./index-B1Jbd6RH.js";const m=()=>{var m,x;const{props:u}=s(),j=(null==(x=null==(m=u.auth)?void 0:m.user)?void 0:x.email)||"",{toast:w}=d(),[g,h]=e.useState(!1),[f,N]=e.useState(!1),[b,y]=e.useState(!1),[v,_]=e.useState(!1),[k,S]=e.useState(""),[C,P]=e.useState(!1),[Y,q]=e.useState({}),[E,z]=e.useState({current_password:"",new_password:"",new_password_confirmation:""});return a.jsxs("div",{className:"my-24 px-5 xl:px-32",children:[a.jsxs(r,{href:"/profile",className:"flex items-center gap-2","aria-label":"Back to Profile",children:[a.jsx(o,{className:"text-2xl"}),a.jsx("h1",{className:"font-bold text-5xl font-oswald",children:"Profile"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-5",children:[a.jsx(c,{}),a.jsxs("div",{className:"col-span-3 my-3",children:[a.jsxs("div",{className:"grid grid-cols-4 items-center",children:[a.jsx("h2",{className:"col-span-3 text-2xl font-bold font-oswald",children:"Parolni tahrirlash"}),a.jsx(p,{})]}),a.jsxs("form",{onSubmit:async s=>{s.preventDefault(),P(!0),q({});try{await t.post("/update-password",E);S(j),_(!0)}catch(e){e.response&&422===e.response.status?q(e.response.data.errors||{}):w({title:"Error",description:"Noma’lum xatolik yuz berdi. Iltimos, keyinroq urinib ko‘ring."})}finally{P(!1)}},className:"grid grid-cols-1 max-w-md p-5 gap-5",children:[a.jsxs("div",{className:"bg-slate-100 p-3 rounded-lg space-y-2 relative",children:[a.jsx("h3",{className:"font-oswald",children:"Joriy parol:"}),a.jsx("input",{type:g?"text":"password",value:E.current_password,onChange:s=>z({...E,current_password:s.target.value}),placeholder:"Joriy parolni kiriting",className:"bg-transparent w-full outline-none pr-8"}),a.jsx("span",{onClick:()=>h(s=>!s),className:"absolute right-2 top-6 cursor-pointer text-2xl p-3",children:g?a.jsx(i,{}):a.jsx(n,{})}),Y.current_password&&a.jsx("p",{className:"text-red-500 text-sm",children:Y.current_password})]}),a.jsxs("div",{className:"bg-slate-100 p-3 rounded-lg space-y-2 relative",children:[a.jsx("h3",{className:"font-oswald",children:"Yangi parol:"}),a.jsx("input",{type:f?"text":"password",value:E.new_password,onChange:s=>z({...E,new_password:s.target.value}),placeholder:"Yangi parolni kiriting",className:"bg-transparent w-full outline-none"}),a.jsx("span",{onClick:()=>N(s=>!s),className:"absolute right-2 top-6 cursor-pointer text-2xl p-3",children:f?a.jsx(i,{}):a.jsx(n,{})}),Y.new_password&&a.jsx("p",{className:"text-red-500 text-sm",children:Y.new_password})]}),a.jsxs("div",{className:"bg-slate-100 p-3 rounded-lg space-y-2 relative",children:[a.jsx("h3",{className:"font-oswald",children:"Yangi parolni takrorlang:"}),a.jsx("input",{type:b?"text":"password",value:E.new_password_confirmation,onChange:s=>z({...E,new_password_confirmation:s.target.value}),placeholder:"Yangi parolni takrorlang",className:"bg-transparent w-full outline-none"}),a.jsx("span",{onClick:()=>y(s=>!s),className:"absolute right-2 top-6 cursor-pointer text-2xl p-3",children:b?a.jsx(i,{}):a.jsx(n,{})}),Y.new_password_confirmation&&a.jsx("p",{className:"text-red-500 text-sm",children:Y.new_password_confirmation})]}),a.jsx("button",{type:"submit",disabled:C,className:"p-3 bg-black text-white w-[40%] sm:w-[20%] rounded-lg text-center",children:"Saqlash"})]})]})]}),a.jsx(l,{isOpen:v,onClose:()=>_(!1),onSubmit:async s=>{try{const e=await t.post("/verify-password-code",{code:s});w({title:"Muvaffaqiyatli",description:e.data.message}),_(!1)}catch(e){e.response&&422===e.response.status?w({title:"Error",description:"❌ Kod noto‘g‘ri yoki muddati tugagan.'"}):w({title:"Error",description:"'Noma’lum xatolik yuz berdi."})}},email:k})]})};export{m as default};
