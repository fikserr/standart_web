import{c as e,r as t,m as s,j as a,B as l,Y as r}from"./app-0nnjcZrn.js";import{u as i}from"./use-toast-Dj50PcGS.js";import{P as n,a as o,b as c}from"./pagination-B_Sx9wkE.js";import{a as d}from"./index-D7aLGra3.js";import"./iconBase-x5fZwo94.js";
/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h=e("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),m=e("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),x=({products:e})=>{const[x,u]=t.useState(!1),[p,j]=t.useState(null),[g,b]=t.useState([]),[v,f]=t.useState({}),[y,N]=t.useState(null),{toast:k}=i(),[w,S]=t.useState(null),[z,C]=t.useState([]),[T,M]=t.useState("");t.useEffect(()=>{const t=setInterval(()=>{f(t=>{const s={};return e.data.forEach(e=>{const a=[e.photo1,e.photo2,e.photo3].filter(Boolean),l=t[e.id]||0;s[e.id]=(l+1)%a.length}),s})},5e3);return()=>clearInterval(t)},[e]);const $=async e=>{try{const t=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),s=await fetch(`/admin-delete-product/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":t,"X-Requested-With":"XMLHttpRequest"}});if(s.ok){const e=await s.json();k({title:"✅ Mahsulot o‘chirildi",description:e.message}),setTimeout(()=>{window.location.reload()},1500)}else k({variant:"destructive",title:"❌ Xatolik",description:"Mahsulotni o‘chirishda muammo yuz berdi."})}catch(t){console.error("Xatolik:",t),k({variant:"destructive",title:"❌ Server xatosi",description:"Tarmoqda muammo yuz berdi."})}};return t.useEffect(()=>{const e=setTimeout(()=>{s.get("/admin-productStock",{search:T},{preserveState:!0})},500);return()=>clearTimeout(e)},[T]),a.jsxs("div",{className:"p-6 mx-5 w-[1200px]",children:[a.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Product Stock"}),a.jsxs("div",{className:"mb-4 flex items-center border max-w-sm rounded-lg px-3",children:[a.jsx("input",{placeholder:"Tovarlar nomi bilan izlash...",value:T,onChange:e=>{const t=e.target.value;M(t),s.get("/admin-users",{search:t},{preserveState:!0})},className:"w-full border-none outline-none p-1"}),a.jsx(d,{style:{fontSize:"22px"}})]}),a.jsxs("div",{className:"",children:[a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"text-left border-b",children:a.jsxs("tr",{children:[a.jsx("th",{className:"py-2",children:"Image"}),a.jsx("th",{children:"Product Name"}),a.jsx("th",{children:"Category"}),a.jsx("th",{children:"Price"}),a.jsx("th",{children:"Brand"}),a.jsx("th",{children:"Available Color"}),a.jsx("th",{children:"Action"})]})}),a.jsx("tbody",{children:e.data.map((e,t)=>{var s;const i=[e.photo1,e.photo2,e.photo3].filter(Boolean),n=i[v[e.id]||0];return a.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[a.jsx("td",{className:"py-2",children:a.jsx("div",{className:"relative w-24 h-24 flex items-center justify-center",children:a.jsx("img",{src:`/storage/${n}?v=${Date.now()}`,loading:"lazy",alt:e.product_name,className:"w-20 h-20 rounded object-cover cursor-zoom-in",onClick:()=>((e,t,s)=>{N(t),S(e),C(s)})(e.id,`/storage/${n}`,i)})})}),a.jsx("td",{children:e.product_name}),a.jsx("td",{children:(null==(s=e.category)?void 0:s.name)||"—"}),a.jsx("td",{children:e.price}),a.jsx("td",{children:e.brend}),a.jsx("td",{children:e.colors}),a.jsx("td",{children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(l,{size:"icon",variant:"outline",children:a.jsx(r,{href:`/admin-products/${e.id}/edit`,children:a.jsx(h,{className:"w-4 h-4"})})}),a.jsx(l,{size:"icon",variant:"outline",className:"text-red-500",onClick:()=>$(e.id),children:a.jsx(m,{className:"w-4 h-4"})})]})})]},t)})})]}),y&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:a.jsxs("div",{className:"relative max-w-3xl w-full mx-4",children:[a.jsx("button",{onClick:()=>{N(null)},className:"absolute top-4 right-4 text-xl",title:"Yopish",children:"✖"}),z.length>1&&a.jsx("button",{onClick:()=>{const e=(z.findIndex(e=>`/storage/${e}`===y)-1+z.length)%z.length;N(`/storage/${z[e]}`)},className:"absolute left-2 top-1/2 hover:bg-black duration-700 bg-opacity-55 text-white p-2 px-4 rounded",children:"‹"}),a.jsx("img",{src:y,loading:"lazy",alt:"Product preview",className:"max-h-[70vh] w-full object-cover rounded shadow-lg"}),z.length>1&&a.jsx("button",{onClick:()=>{const e=(z.findIndex(e=>`/storage/${e}`===y)+1)%z.length;N(`/storage/${z[e]}`)},className:"absolute right-2 top-1/2 hover:bg-black duration-700 bg-opacity-50 text-white p-2 px-4 rounded",children:"›"})]})}),x&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md max-w-md w-full",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Tovarni o‘chirishni tasdiqlang"}),a.jsx("p",{className:"mb-6",children:"Ushbu tovarni rostdan ham o‘chirib tashlamoqchimisiz?"}),a.jsxs("div",{className:"flex justify-end gap-4",children:[a.jsx(l,{variant:"outline",onClick:()=>{u(!1),j(null),b([])},children:"Bekor qilish"}),a.jsx(l,{variant:"destructive",onClick:$,children:"O‘chirish"})]})]})}),e.total?a.jsx(n,{className:"mt-5",children:a.jsx(o,{children:e.links.map((e,t)=>a.jsx(c,{children:e.url?a.jsx(r,{href:e.url,className:"px-3 py-1 rounded hover:bg-gray-200 "+(e.active?"bg-gray-300 font-bold":""),dangerouslySetInnerHTML:{__html:e.label}}):a.jsx("span",{className:"px-3 py-1 text-gray-400",dangerouslySetInnerHTML:{__html:e.label}})},t))})}):""]})]})};export{x as default};
